<div class="detail-page">
  <!-- Navbar -->
  <nav class="food-navbar">
    <div class="logo" routerLink="/home">
      <img src="https://i.pinimg.com/736x/d2/56/8c/d2568c83e1edc3c7a5b9aaf6b575f7d9.jpg" alt="Foodiee Logo" class="logo-img" />
      <span class="logo-text">Foodiee<span>.co</span></span>
    </div>
  </nav>

  <div class="food-detail-container">
    <button class="back-btn" (click)="goBack()">← Back to Home</button>

    <div class="food-content">
      <!-- Left: Media (YouTube > Video > Image) -->
      <div class="video-box">
        <ng-container *ngIf="safeYoutubeUrl; else html5OrImage">
          <div class="embed-wrap">
            <iframe class="yt-embed" [src]="safeYoutubeUrl" title="Recipe Video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
          </div>
        </ng-container>
        <ng-template #html5OrImage>
          <ng-container *ngIf="foodItem?.video; else imageOnly">
            <video controls [src]="foodItem?.video" class="food-video"></video>
          </ng-container>
          <ng-template #imageOnly>
            <img [src]="foodItem?.image" [alt]="foodItem?.title" class="food-video" />
          </ng-template>
        </ng-template>
      </div>

      <!-- Right: Ingredients -->
      <div class="info-column">
        <h2>{{ foodItem?.title }}</h2>
        <!-- Actions: Save / Favorite -->
        <div class="detail-actions" *ngIf="foodItem">
          <button type="button" (click)="toggleSave(foodItem.id)">
            {{ isSaved(foodItem.id) ? '💾 Saved' : '💾 Save' }}
          </button>
          <button type="button" (click)="toggleFavorite(foodItem.id)">
            {{ isFavorited(foodItem.id) ? '❤️ Favourited' : '🤍 Favourite' }}
          </button>
        </div>
        <!-- Rating Section -->
        <div class="rating-wrap" *ngIf="foodItem">
          <div class="rating-row">
            <button class="star" type="button" *ngFor="let s of [1,2,3,4,5]"
              [class.filled]="hoverRating ? s <= hoverRating : s <= currentUserRating"
              (mouseenter)="setHover(s)" (mouseleave)="clearHover()"
              (click)="submitRating(s)"
              [attr.aria-label]="'Rate ' + s + ' star'">
              ★
            </button>
          </div>
          <div class="rating-meta">
            <span class="avg">{{ averageRating || 0 }} / 5</span>
            <span class="count">({{ ratingCount }} ratings)</span>
            <span class="you" *ngIf="currentUserRating">• You rated: {{ currentUserRating }}</span>
          </div>
        </div>
        <!-- Share Section -->
        <div class="share-wrap" *ngIf="foodItem">
          <button type="button" class="share-btn wa" (click)="shareWhatsApp()" aria-label="Share on WhatsApp">WhatsApp</button>
          <button type="button" class="share-btn pin" (click)="sharePinterest()" aria-label="Share on Pinterest">Pinterest</button>
          <button type="button" class="share-btn native" (click)="shareNative()" aria-label="Share">Share</button>
        </div>
        <div class="ingredients">
          <h3>Ingredients</h3>
          <ul>
            <li *ngFor="let item of foodItem?.ingredients; let i = index" [style.--i]="i">{{ item }}</li>
          </ul>

        </div>
      </div>
    </div>

    <!-- Cooking steps -->
    <div class="description" *ngIf="foodItem?.description">
      <h3>Cooking Steps</h3>
      <p [innerHTML]="foodItem.description"></p>
    </div>
  </div>
</div>
